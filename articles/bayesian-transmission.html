<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>bayesian-transmission • bayestransmission</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="bayesian-transmission">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bayestransmission</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bayesian-transmission.html">bayesian-transmission</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>bayesian-transmission</h1>
            
      

      <div class="d-none name"><code>bayesian-transmission.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://epiforesite.github.io/bayesian-transmission/">bayestransmission</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This package provides a Bayesian framework for transmission modeling
on an individual patient level. Modeling is conducted through Markov
Chain Monte Carlo (MCMC) methods.This document will explain the basic
usage of the package, specification of parameters, and the output of the
model.</p>
</div>
<div class="section level2">
<h2 id="data-structure">Data Structure<a class="anchor" aria-label="anchor" href="#data-structure"></a>
</h2>
<p>The algorithms expect a longitudinal data set with the following
columns: * <code>facility</code>: The facility where the event occurred.
* <code>unit</code>: The unit within the facility where the event
occurred. * <code>time</code>: The time at which the event occurred. *
<code>patient</code>: The patient involved in the event. *
<code>type</code>: The type of event.</p>
<p>The package includes a simulated dataset,
<code>simulated.data</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pillar</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">simulated.data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 8,360</span></span>
<span><span class="co">#&gt; Columns: 5</span></span>
<span><span class="co">#&gt; $ facility <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ unit     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ time     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.060978<span style="color: #949494;">, </span>0.061978<span style="color: #949494;">, </span>1.560978<span style="color: #949494;">, </span>2.883323<span style="color: #949494;">, </span>2.884323<span style="color: #949494;">, </span>1.422631<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ patient  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>19<span style="color: #949494;">, </span>19<span style="color: #949494;">, </span>19<span style="color: #949494;">, </span>23<span style="color: #949494;">, </span>23<span style="color: #949494;">, </span>23<span style="color: #949494;">, </span>28<span style="color: #949494;">, </span>28…</span></span>
<span><span class="co">#&gt; $ type     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>…</span></span></code></pre></div>
<p>There are 12 different types of events that can be specified in the
<code>type</code> column. These are, expected numerical codes shown in
parentheses:</p>
<ul>
<li>Admission (0) and Discharge (3)</li>
<li>Surveillance Testing Results
<ul>
<li>Negative Test (1)</li>
<li>Positive Test (2)</li>
</ul>
</li>
<li>Clinical Testing Results
<ul>
<li>Negative Test (4)</li>
<li>Positive Test (5)</li>
</ul>
</li>
<li>Generic Testing
<ul>
<li>Negative Test (7)</li>
<li>Positive Test (8)</li>
</ul>
</li>
<li>Antibiotic Use
<ul>
<li>single dose (9)</li>
<li>Start (10)</li>
<li>Stop (11)</li>
</ul>
</li>
<li>Isolation Procedures
<ul>
<li>Start (6)</li>
<li>Stop (7)</li>
</ul>
</li>
</ul>
<p>Not all events need to be used in every data set, but the model
selected should reflect the data that is available. Care should be taken
to correctly code the data. The <code>EventToCode</code> and
<code>CodeToEvent</code> functions can be used to convert between.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/CodeToEvent.html">CodeToEvent</a></span><span class="op">(</span><span class="va">simulated.data</span><span class="op">$</span><span class="va">type</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      abxoff       abxon   admission   discharge negsurvtest possurvtest </span></span>
<span><span class="co">#&gt;         297         725        2183        2183        2749         223</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-specifiction">Model Specifiction<a class="anchor" aria-label="anchor" href="#model-specifiction"></a>
</h2>
<div class="section level3">
<h3 id="model-choice">Model Choice<a class="anchor" aria-label="anchor" href="#model-choice"></a>
</h3>
<p>Since the model is implemented in C++ for speed and efficiency, only
the specified models can be used. The currently implemented models
are:</p>
<ul>
<li>
<code>"LinearAbxModel"</code>, A Linear model with antibiotic use as
a covariate.</li>
<li>
<code>"MixedModel"</code>, and</li>
<li><code>"LogNormalModel"</code></li>
</ul>
<p>Model specification and all parameters are controlled through
constructor functions of the same name, or generically through the
<code><a href="../reference/LogNormalModelParams.html">LogNormalModelParams()</a></code> function.</p>
<p>For all models there is the choice of either a 2 state (susceptible
and colonized) or 3 state (susceptible, colonized, and recovered or
latent) model. Number of states is set through the <code>nstates</code>
parameter, and the number of states in the model overrides what may be
specified in any individual component.</p>
</div>
<div class="section level3">
<h3 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<p>The remainder of the parameters are grouped into the following
categories:</p>
<ul>
<li>
<code>Abx</code>, Antibiotic use,</li>
<li>
<code>AbxRate</code>, Antibiotic rates,</li>
<li>
<code>InUnit</code>, In unit infection rates,</li>
<li>
<code>OutOfUnitInfection</code>, Out of unit infection rates,</li>
<li>
<code>Insitu</code>, In situ parameters,</li>
<li>Testing:
<ul>
<li>
<code>SurveilenceTest</code>, Surveillance testing,</li>
<li>
<code>ClinicalTest</code>, Clinical testing.</li>
</ul>
</li>
</ul>
<p>Unless otherwise specified the parameters are all distributed gamma
with specified shape and rate parameters. Each parameter can also be
left as fixed or be sampled at each iteration of the MCMC.</p>
<div class="section level4">
<h4 id="specifying-parameters">Specifying parameters<a class="anchor" aria-label="anchor" href="#specifying-parameters"></a>
</h4>
<p>Parameters for the model may be specified by the <code><a href="../reference/Param.html">Param()</a></code>
function. This function takes up to four arguments:</p>
<pre><code>1. `init`, is the initial value of the parameter.
2. `weight`, is the weight of the prior distribution in updates.
3. `update`, a flag of if the parameter should be sampled in the MCMC algorithm. 
    `FALSE` indicates that the parameter should be fixed, and is by default `TRUE` when `weight` is greater than zero.
4. `prior`, the mean of the prior distribution.  Taken with the weight will fully parameterize the distribution.</code></pre>
<p><strong>Important:</strong> Always explicitly specify
<code>init</code> values for parameters to ensure reproducibility and
avoid potential numerical issues.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fully specified parameter.</span></span>
<span><span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0</span>, weight <span class="op">=</span> <span class="fl">1</span>, update <span class="op">=</span> <span class="cn">TRUE</span>, prior <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># Fixed parameter with explicit init</span></span>
<span><span class="co"># Weight = 0 implies update=FALSE and prior is ignored.</span></span>
<span><span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># Updated parameter that starts at zero.</span></span>
<span><span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0</span>, weight <span class="op">=</span> <span class="fl">1</span>, update <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Short form for fixed parameter</span></span>
<span><span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="abx-antibiotic-use">
<code>Abx</code> Antibiotic use<a class="anchor" aria-label="anchor" href="#abx-antibiotic-use"></a>
</h3>
<p>Antibiotic use is specified by the <code>Abx</code> parameter. This
parameter is a list constructed with the <code><a href="../reference/AbxParams.html">AbxParams()</a></code>
function with the following components:</p>
<ul>
<li>
<code>onoff</code>, If antibiotics are being used or not. The two
following parameters are only used if <code>onoff</code> is
<code>TRUE</code>.</li>
<li>
<code>delay</code>, the delay for the antibiotic to take
effect.</li>
<li>
<code>life</code>, the duration where the antibiotic to be
effective.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">abx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AbxParams.html">AbxParams</a></span><span class="op">(</span>onoff <span class="op">=</span> <span class="fl">0</span>, delay <span class="op">=</span> <span class="fl">0.0</span>, life <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span></span></code></pre></div>
<p>Currently, all antibiotics are assumed to be equally effective and
have the same duration of effectiveness. Note: <code>onoff = 0</code>
means antibiotics are turned off for this example (set to 1 to
enable).</p>
</div>
<div class="section level3">
<h3 id="abxrate-antibiotic-rates">
<code>AbxRate</code> Antibiotic rates<a class="anchor" aria-label="anchor" href="#abxrate-antibiotic-rates"></a>
</h3>
<p>The <code>AbxRate</code> parameter control the antibiotic
administration rates.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">abxrate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AbxRateParams.html">AbxRateParams</a></span><span class="op">(</span></span>
<span>  <span class="co"># Fixed parameters when antibiotics are off</span></span>
<span>  uncolonized <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  colonized <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here since both parameters are non-zero both will be updated. A rate
of zero for either would indicate that group would never be on
antibiotics. When antibiotics are turned off
(<code>Abx$onoff = 0</code>), these parameters are typically fixed
(weight = 0).</p>
</div>
<div class="section level3">
<h3 id="inunit-in-unit-infection-rate">
<code>InUnit</code> In unit infection rate<a class="anchor" aria-label="anchor" href="#inunit-in-unit-infection-rate"></a>
</h3>
<p>Transmission within unit is the main defining characteristic that
differentiates models. For example the linear antibiotic model,
<code><a href="../reference/LogNormalModelParams.html">LinearAbxModel()</a></code>, is differentiated from the log normal
model, <code><a href="../reference/LogNormalModelParams.html">LogNormalModelParams()</a></code> by the use of a
<code><a href="../reference/InUnitParams.html">ABXInUnitParams()</a></code> for the <code>InUnit</code> argument
rather than the <code>LogNormalInUnitAcquisition()</code> which does not
take into account antibiotic use. All in unit transmission is defined in
terms of acquisition, progression, and clearance.</p>
<div class="section level4">
<h4 id="aqcuisition-model">Aqcuisition Model<a class="anchor" aria-label="anchor" href="#aqcuisition-model"></a>
</h4>
<p>In the base log normal antibiotic model,
<code>LogNormalABXInUnitParameters()</code> log acquisition probability
is a linear function.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi mathvariant="normal">A</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">q</mi><mrow><mo stretchy="true" form="prefix" mathvariant="normal">(</mo><mi mathvariant="normal">t</mi><mo stretchy="true" form="postfix" mathvariant="normal">)</mo></mrow></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mi>t</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mi>c</mi></msub><msub><mi>N</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mi>c</mi><mi>a</mi></mrow></msub><msub><mi>N</mi><mrow><mi>c</mi><mi>a</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mi>A</mi></msub><msub><mi>A</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mi>E</mi></msub><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\log(P(\mathrm{Acq(t)})) =  % lognormal_logNormalAbxICP.cpp:68-74
    \beta_0 +               % logbeta_acq_constant
    \beta_t (t-t_0) +       % logbeta_acq_time
    \beta_c N_c(t)  +       % logbeta_acq_col() * ncol +
    \beta_{ca} N_{ca}(t) +  % logbeta_acq_abx_col() * ncolabx +
    \beta_A A_i(t) +        % logbeta_acq_onabx() * onabx +
    \beta_E E_i(t)          % logbeta_acq_everabx() * everabx;
</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mo>⋆</mo></msub><annotation encoding="application/x-tex">\beta_\star</annotation></semantics></math>
represents the coefficient corresponding to the amounts,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_c(t)</annotation></semantics></math>
represent the total number of colonized patients at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><mi>c</mi><mi>a</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_{ca}(t)</annotation></semantics></math>
the number of colonized on antibiotics, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">A_i(t)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E_i(t)</annotation></semantics></math>
represents if patient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is currently or ever on antibiotics.</p>
<p>The linear antibiotic (<code>LinearAbxAcquisitionParams</code>) takes
a more complicated form for the acquisition model.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi mathvariant="normal">A</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">q</mi><mrow><mo stretchy="true" form="prefix" mathvariant="normal">(</mo><mi mathvariant="normal">t</mi><mo stretchy="true" form="postfix" mathvariant="normal">)</mo></mrow></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>e</mi><mrow><msub><mi>β</mi><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">{</mo><msup><mi>e</mi><msub><mi>β</mi><mn>0</mn></msub></msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>β</mi><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">q</mi></mrow></msub><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><msub><mi>β</mi><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">q</mi></mrow></msub></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><msub><mi>β</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi></mrow></msub></msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>N</mi><mrow><mi>c</mi><mi>a</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mi>e</mi><msub><mi>β</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">x</mi></mrow></msub></msup><msub><mi>N</mi><mrow><mi>c</mi><mi>a</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><msub><mi>β</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi></mrow></msub></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>N</mi><mi>S</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>N</mi><mi>E</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mi>e</mi><msub><mi>β</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow></msub></msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>A</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>A</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><msub><mi>β</mi><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">x</mi></mrow></msub></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
P(\mathrm{Acq(t)}) =
  \left[e^{\beta_\mathrm{time}(t-t_0)}\right]
  \left\{e^{\beta_0}
         \left[
            \left(\frac{\beta_\mathrm{freq}}{P(t)}+(1 - e^{\beta_\mathrm{freq}})\right)
            e^{\beta_\mathrm{mass}}\left(
                (N_c(t) - N_{ca}(t)) + e^{\beta_\mathrm{col\_abx}}N_{ca}(t)
            \right)
          + 1 - e^{\beta_\mathrm{mass}}
        \right]
  \right\}
  \left[
    N_S(t) - N_E(t) + e^{\beta_\mathrm{suss\_ever}}\left(\left(E_i(t)-A_i(t)\right) +A_i(t)e^{\beta_\mathrm{suss\_abx}}\right)
  \right]
</annotation></semantics></math></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acquisition</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LinearAbxAcquisitionParams.html">LinearAbxAcquisitionParams</a></span><span class="op">(</span></span>
<span>    base <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.001</span>, weight <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,     <span class="co">#&lt; Base acquisition rate (Updated)</span></span>
<span>    time <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,       <span class="co">#&lt; Time effect (Fixed)</span></span>
<span>    mass <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,       <span class="co">#&lt; Mass Mixing (Updated)</span></span>
<span>    freq <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,       <span class="co">#&lt; Frequency/Density effect (Updated)</span></span>
<span>    col_abx <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,    <span class="co">#&lt; Colonized on antibiotics (Fixed)</span></span>
<span>    suss_abx <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,   <span class="co">#&lt; Susceptible on antibiotics (Fixed)</span></span>
<span>    suss_ever <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>   <span class="co">#&lt; Ever on antibiotics (Fixed)  </span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="progression-model">Progression Model<a class="anchor" aria-label="anchor" href="#progression-model"></a>
</h4>
<p>In the 3 state model there is a latent state and the progression
model controls how patient transition out of the latent state. The base
rate can be affected by currently being on antiboitics or ever being on
antbiotcs.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>δ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>δ</mi><mi>A</mi></msub><msub><mi>A</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>δ</mi><mi>E</mi></msub><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\log(P(\mathrm{progression})) = \delta_0+\delta_AA_i(t) + \delta_EE_i(t)
</annotation></semantics></math> the linear antibiotic model is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><msub><mi>δ</mi><mn>0</mn></msub></msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mi>e</mi><msub><mi>δ</mi><mn>2</mn></msub></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>A</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mi>e</mi><msub><mi>δ</mi><mn>1</mn></msub></msup><msub><mi>A</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
P(\mathrm{progression}) = e^{\delta_0}\left[1-E_i(t)+e^{\delta_2}\left(E_i(t)-A_i(t)+e^{\delta_1}A_i(t)\right)\right]
</annotation></semantics></math></p>
<p>Where here we use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
for the coefficients, but the notation is the same.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">progression</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ProgressionParams.html">ProgressionParams</a></span><span class="op">(</span></span>
<span>    rate <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,      <span class="co">#&lt; Base progression rate (Fixed for 2-state)</span></span>
<span>    abx  <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,      <span class="co">#&lt; Currently on antibiotics (Fixed)</span></span>
<span>    ever_abx <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>   <span class="co">#&lt; Ever on antibiotics (Fixed)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="clearance-model">Clearance Model<a class="anchor" aria-label="anchor" href="#clearance-model"></a>
</h4>
<p>The clearance model is the same as the progression model in both the
log normal and the linear cases, the coefficients however are
independent.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clearance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ClearanceParams.html">ClearanceParams</a></span><span class="op">(</span></span>
<span>    rate <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.01</span>, weight <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,     <span class="co">#&lt; Base clearance rate (Updated)</span></span>
<span>    abx  <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,      <span class="co">#&lt; Currently on antibiotics (Fixed)</span></span>
<span>    ever_abx <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>   <span class="co">#&lt; Ever on antibiotics (Fixed)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inunit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InUnitParams.html">ABXInUnitParams</a></span><span class="op">(</span></span>
<span>  acquisition <span class="op">=</span> <span class="va">acquisition</span>,</span>
<span>  progression <span class="op">=</span> <span class="va">progression</span>,</span>
<span>  clearance   <span class="op">=</span> <span class="va">clearance</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="out-of-unit-importation">Out of Unit Importation<a class="anchor" aria-label="anchor" href="#out-of-unit-importation"></a>
</h3>
<p>The out of unit parameters control the rate at which admissions come
in, and which state they enter in.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mi>i</mi></msub><mo>→</mo><msub><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>P</mi><mi>j</mi></msub><mo>−</mo><msub><mi>Q</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><msup><mi>e</mi><mrow><mo>−</mo><mi>t</mi><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>r</mi><mi>i</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">
\log(P(\mathrm{state}_i \rightarrow \mathrm{state}_j)|t) = P_j - Q_{i,j} e^{-t \sum_i r_i}
</annotation></semantics></math></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OutOfUnitInfectionParams.html">OutOfUnitInfectionParams</a></span><span class="op">(</span></span>
<span>  acquisition <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.001</span>, weight <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  clearance <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.01</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  progression <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="in-situ">In Situ<a class="anchor" aria-label="anchor" href="#in-situ"></a>
</h3>
<p>I’m not sure what these parameters do. It’s a set of gamma
distributed parameters one for each state. The updates and probabilities
are not time dependent.</p>
<p>When updating the rates for each state are sampled from a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>a</mi><mi>m</mi><mi>m</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>i</mi></msub><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">gamma(N_i, 1)</annotation></semantics></math>
distribution. Then all three are normalized to sum to 1.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">insitu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InsituParams.html">InsituParams</a></span><span class="op">(</span></span>
<span>  <span class="co"># Starting 90/10 split uncolonized to colonized</span></span>
<span>  <span class="co"># For 2-state model, latent probability is 0</span></span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>uncolonized <span class="op">=</span> <span class="fl">0.90</span>,</span>
<span>            latent <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>            colonized <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span>,</span>
<span>  <span class="co"># Prior values for Bayesian updating  </span></span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="co"># Which states to update (latent is fixed at 0 for 2-state model)</span></span>
<span>  doit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a>
</h3>
<p>There are two types of testing, surveillance, which is conducted
routinely at regular intervals such as on admission then every 3 days
after, and clinical, where the testing is precipitated by staff, and
thus the timing is informative.</p>
<div class="section level4">
<h4 id="surveillance-testing">Surveillance Testing<a class="anchor" aria-label="anchor" href="#surveillance-testing"></a>
</h4>
<p>The timing of surveillance testing is assumed to not be informative.
Therefore, surveillance testing is only parameterized in terms of
probability of a positive test given the underlying status. Surveillance
test parameters are updated with a sample from a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mrow><mi>s</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>N</mi><mrow><mi>s</mi><mo>,</mo><mn>0</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Beta(N_{s,1}, N_{s,0})</annotation></semantics></math>
distribution where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><mi>s</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">N_{s,1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><mi>s</mi><mo>,</mo><mn>0</mn></mrow></msub><annotation encoding="application/x-tex">N_{s,0}</annotation></semantics></math>
are the number of positive and negative tests respectively for state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SurveillanceTestParams.html">SurveillanceTestParams</a></span><span class="op">(</span></span>
<span>    <span class="co"># Probability of a positive test when uncolonized (false positive rate)</span></span>
<span>    <span class="co"># IMPORTANT: Must be &gt; 0 to avoid -Inf likelihood. Use small value like 1e-10.</span></span>
<span>    <span class="co"># Setting to exactly 0.0 causes log(0) = -Inf if any uncolonized patient tests positive.</span></span>
<span>    uncolonized <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1e-10</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="co"># Probability of a positive test when colonized (true positive rate/sensitivity)</span></span>
<span>    <span class="co"># Starting at 0.8, will be updated during MCMC</span></span>
<span>    colonized <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.8</span>, weight <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="co"># Latent state (for 2-state model, this is not used but must be specified)</span></span>
<span>    latent <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="clinical-testing">Clinical Testing<a class="anchor" aria-label="anchor" href="#clinical-testing"></a>
</h4>
<p>Since clinical testing time is informative, clinical testing is
assumed to be at random within infection stage. The rate of testing
within each stage is sampled from a gamma distribution.
Sensitivity/Specificity are handled the same as surveillance testing and
the likelihood is multiplicative between rate and effectiveness.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RandomTestParams.html">RandomTestParams</a></span><span class="op">(</span></span>
<span>    <span class="co"># Rate of testing when uncolonized</span></span>
<span>    uncolonized <span class="op">=</span> <span class="fu"><a href="../reference/ParamWRate.html">ParamWRate</a></span><span class="op">(</span></span>
<span>      param <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.5</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, </span>
<span>      rate <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># Rate of testing when colonized  </span></span>
<span>    colonized <span class="op">=</span> <span class="fu"><a href="../reference/ParamWRate.html">ParamWRate</a></span><span class="op">(</span></span>
<span>      param <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.5</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, </span>
<span>      rate <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># Latent state (for 2-state model, not used but must be specified)</span></span>
<span>    latent <span class="op">=</span> <span class="fu"><a href="../reference/ParamWRate.html">ParamWRate</a></span><span class="op">(</span></span>
<span>      param <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">0.5</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, </span>
<span>      rate <span class="op">=</span> <span class="fu"><a href="../reference/Param.html">Param</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1.0</span>, weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="all-together">All Together<a class="anchor" aria-label="anchor" href="#all-together"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LogNormalModelParams.html">LinearAbxModel</a></span><span class="op">(</span></span>
<span>  nstates <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  Insitu <span class="op">=</span> <span class="va">insitu</span>,</span>
<span>  SurveillanceTest <span class="op">=</span> <span class="va">surv</span>,</span>
<span>  ClinicalTest <span class="op">=</span> <span class="va">clin</span>,</span>
<span>  OutOfUnitInfection <span class="op">=</span> <span class="va">outcol</span>,</span>
<span>  InUnit <span class="op">=</span> <span class="va">inunit</span>,</span>
<span>  Abx <span class="op">=</span> <span class="va">abx</span>,</span>
<span>  AbxRate <span class="op">=</span> <span class="va">abxrate</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="running-the-model">Running the Model<a class="anchor" aria-label="anchor" href="#running-the-model"></a>
</h2>
<p>The model is run through the <code><a href="../reference/runMCMC.html">runMCMC()</a></code> function. The
function takes the following arguments:</p>
<ul>
<li>
<code>data</code>: The data frame with patient event data</li>
<li>
<code>modelParameters</code>: The model specification (created
above)</li>
<li>
<code>nsims</code>: Number of MCMC samples to collect after
burn-in</li>
<li>
<code>nburn</code>: Number of burn-in iterations (default: 100)</li>
<li>
<code>outputparam</code>: Whether to save parameter values at each
iteration (default: TRUE)</li>
<li>
<code>outputfinal</code>: Whether to save the final model state
(default: FALSE)</li>
<li>
<code>verbose</code>: Whether to print progress messages (default:
FALSE)</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runMCMC.html">runMCMC</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">simulated.data_sorted</span>,</span>
<span>    modelParameters <span class="op">=</span> <span class="va">params</span>,</span>
<span>    nsims <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    nburn <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    outputparam <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    outputfinal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt; 173.757 160.523 167.506</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyzing-mcmc-results">Analyzing MCMC Results<a class="anchor" aria-label="anchor" href="#analyzing-mcmc-results"></a>
</h2>
<div class="section level3">
<h3 id="converting-parameters-to-data-frame">Converting Parameters to Data Frame<a class="anchor" aria-label="anchor" href="#converting-parameters-to-data-frame"></a>
</h3>
<p>The <code>results$Parameters</code> object contains the MCMC chain of
all model parameters. To create trace plots and posterior distributions,
we use the <code><a href="../reference/mcmc_to_dataframe.html">mcmc_to_dataframe()</a></code> function to convert this
nested list structure into a tidy data frame format.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert parameters to data frame using package function</span></span>
<span><span class="va">param_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmc_to_dataframe.html">mcmc_to_dataframe</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display first few rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">param_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   iteration insitu_uncolonized insitu_colonized surv_test_uncol_neg</span></span>
<span><span class="co">#&gt; 1         1         0.65408410      0.345915901               1e-10</span></span>
<span><span class="co">#&gt; 2         2         0.41940536      0.580594642               1e-10</span></span>
<span><span class="co">#&gt; 3         3         0.00480183      0.995198170               1e-10</span></span>
<span><span class="co">#&gt; 4         4         0.97985172      0.020148280               1e-10</span></span>
<span><span class="co">#&gt; 5         5         0.99855862      0.001441382               1e-10</span></span>
<span><span class="co">#&gt; 6         6         0.39104620      0.608953797               1e-10</span></span>
<span><span class="co">#&gt;   surv_test_col_neg surv_test_uncol_pos surv_test_col_pos clin_test_uncol</span></span>
<span><span class="co">#&gt; 1         0.8447528               1e-10         0.9998983             0.5</span></span>
<span><span class="co">#&gt; 2         0.8029492               1e-10         0.2790169             0.5</span></span>
<span><span class="co">#&gt; 3         0.8518281               1e-10         1.0000000             0.5</span></span>
<span><span class="co">#&gt; 4         0.8484905               1e-10         0.9995797             0.5</span></span>
<span><span class="co">#&gt; 5         0.8526668               1e-10         0.4436542             0.5</span></span>
<span><span class="co">#&gt; 6         0.7994312               1e-10         0.5293115             0.5</span></span>
<span><span class="co">#&gt;   clin_test_col clin_rate_uncol clin_rate_col outunit_acquisition</span></span>
<span><span class="co">#&gt; 1           0.5               1             1          0.00103972</span></span>
<span><span class="co">#&gt; 2           0.5               1             1          0.00103972</span></span>
<span><span class="co">#&gt; 3           0.5               1             1          0.00103972</span></span>
<span><span class="co">#&gt; 4           0.5               1             1          0.00103972</span></span>
<span><span class="co">#&gt; 5           0.5               1             1          0.00103972</span></span>
<span><span class="co">#&gt; 6           0.5               1             1          0.00103972</span></span>
<span><span class="co">#&gt;   outunit_clearance  inunit_base inunit_time inunit_mass inunit_freq</span></span>
<span><span class="co">#&gt; 1              0.01 0.0003624024           1           1           1</span></span>
<span><span class="co">#&gt; 2              0.01 0.0004016161           1           1           1</span></span>
<span><span class="co">#&gt; 3              0.01 0.0004127463           1           1           1</span></span>
<span><span class="co">#&gt; 4              0.01 0.0004347049           1           1           1</span></span>
<span><span class="co">#&gt; 5              0.01 0.0003035432           1           1           1</span></span>
<span><span class="co">#&gt; 6              0.01 0.0003274638           1           1           1</span></span>
<span><span class="co">#&gt;   inunit_colabx inunit_susabx inunit_susever  inunit_clr inunit_clrAbx</span></span>
<span><span class="co">#&gt; 1             1             1              1 0.002108148             1</span></span>
<span><span class="co">#&gt; 2             1             1              1 0.002154422             1</span></span>
<span><span class="co">#&gt; 3             1             1              1 0.002246149             1</span></span>
<span><span class="co">#&gt; 4             1             1              1 0.002240994             1</span></span>
<span><span class="co">#&gt; 5             1             1              1 0.002207258             1</span></span>
<span><span class="co">#&gt; 6             1             1              1 0.002068119             1</span></span>
<span><span class="co">#&gt;   inunit_clrEver abxrate_uncolonized abxrate_colonized loglikelihood</span></span>
<span><span class="co">#&gt; 1              1                   1                 1     -12971.40</span></span>
<span><span class="co">#&gt; 2              1                   1                 1     -12975.10</span></span>
<span><span class="co">#&gt; 3              1                   1                 1     -12994.34</span></span>
<span><span class="co">#&gt; 4              1                   1                 1     -13008.59</span></span>
<span><span class="co">#&gt; 5              1                   1                 1     -12992.41</span></span>
<span><span class="co">#&gt; 6              1                   1                 1     -13019.92</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="trace-plots">Trace Plots<a class="anchor" aria-label="anchor" href="#trace-plots"></a>
</h3>
<p>Trace plots show the evolution of parameters across MCMC iterations,
helping to assess convergence.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select key parameters for trace plots</span></span>
<span><span class="va">trace_params</span> <span class="op">&lt;-</span> <span class="va">param_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iteration"</span>, <span class="st">"insitu_colonized"</span>, <span class="st">"surv_test_col_pos"</span>, </span>
<span>                              <span class="st">"outunit_acquisition"</span>, <span class="st">"inunit_base"</span>, </span>
<span>                              <span class="st">"abxrate_colonized"</span>, <span class="st">"loglikelihood"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Convert to long format</span></span>
<span><span class="va">trace_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">trace_params</span>, </span>
<span>                           cols <span class="op">=</span> <span class="op">-</span><span class="va">iteration</span>,</span>
<span>                           names_to <span class="op">=</span> <span class="st">"parameter"</span>,</span>
<span>                           values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create trace plots</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">trace_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iteration</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">parameter</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"MCMC Trace Plots"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Iteration"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Parameter Value"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayesian-transmission_files/figure-html/unnamed-chunk-17-1.png" class="r-plt" width="960"></p>
</div>
<div class="section level3">
<h3 id="posterior-distributions">Posterior Distributions<a class="anchor" aria-label="anchor" href="#posterior-distributions"></a>
</h3>
<p>Posterior distributions show the estimated distribution of each
parameter after the MCMC sampling.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove burn-in if needed (here we already set nburn in the MCMC call)</span></span>
<span><span class="co"># For demonstration, let's use all samples since nburn=0 was specified</span></span>
<span></span>
<span><span class="co"># Create density plots for posterior distributions</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">trace_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">parameter</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Distributions"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Red dashed line shows posterior mean"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Parameter Value"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayesian-transmission_files/figure-html/unnamed-chunk-18-1.png" class="r-plt" width="960"></p>
</div>
<div class="section level3">
<h3 id="summary-statistics">Summary Statistics<a class="anchor" aria-label="anchor" href="#summary-statistics"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate summary statistics for each parameter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">summary_stats</span> <span class="op">&lt;-</span> <span class="va">trace_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">parameter</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q025 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.025</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q975 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.975</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summary_stats</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   parameter                    mean        median         sd     q025       q975</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> abxrate_colonized        1             1         0          1   <span style="color: #949494;">e</span>+0   1    <span style="color: #949494;">e</span>+0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> insitu_colonized         0.502         0.502     0.293      2.48<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>   9.74 <span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> inunit_base              0.000<span style="text-decoration: underline;">428</span>      0.000<span style="text-decoration: underline;">100</span>  0.000<span style="text-decoration: underline;">704</span>   2.42<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   2.66 <span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> loglikelihood       -<span style="color: #BB0000; text-decoration: underline;">13</span><span style="color: #BB0000;">008.</span>       -<span style="color: #BB0000; text-decoration: underline;">13</span><span style="color: #BB0000;">008.</span>       24.1       -<span style="color: #BB0000;">1.31</span><span style="color: #949494;">e</span>+4  -<span style="color: #BB0000;">1.30</span> <span style="color: #949494;">e</span>+4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> outunit_acquisition      0.001<span style="text-decoration: underline;">09</span>       0.001<span style="text-decoration: underline;">09</span>   0.000<span style="text-decoration: underline;">081</span>7  9.57<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>   1.25 <span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> surv_test_col_pos        0.803         0.952     0.276      6.47<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>   1.000<span style="color: #949494;">e</span>+0</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Redd, CDC’s Center for Forecasting and Outbreak Analytics.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
